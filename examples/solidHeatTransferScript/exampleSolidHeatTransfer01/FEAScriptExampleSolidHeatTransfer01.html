<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>FEAScript: Heat Conduction in a Two-Dimensional Fin Example</title>

    <!-- Math.js and Plotly.js libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/5.0.0/math.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.27.0/plotly.min.js"></script>

    <!-- Link to the CSS file -->
    <link href="https://feascript.com/FEAScript-website.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  </head>

  <body>
    <h1>Heat Conduction in a Two-Dimensional Fin Example</h1>
    <div id="solutionPlot"></div>

    <p>
      The mesh configuration and boundary conditions can be adjusted by editing the respective JSON files
      (`meshConfig.json` and `boundaryConditionsConfig.json`). The solver configuration is set explicitly to
      `solidHeatTransferScript` in this example. Please refresh the page to update the results. Detailed
      instructions for this example can be found in the corresponding
      <a
        href="https://github.com/FEAScript/FEAScript-website/blob/main/tutorialSolidHeatTransfer01/tutorialSolidHeatTransfer01.html"
        target="_blank"
        >FEAScript tutorial</a
      >. If you need further assistance, you can visit the
      <a href="https://feascript.com/" target="_blank">FEAScript website</a>.
    </p>

    <p>
      This example requires Cross-Origin Resource Sharing (CORS) to run if the JSON files are stored locally.
      To enable CORS on Firefox, you can follow these steps:
    </p>
    <ol>
      <li>Open Firefox and type <code>about:config</code> in the address bar, then press Enter.</li>
      <li>Accept the risk and continue to the advanced settings.</li>
      <li>
        In the search bar, type
        <code>security.fileuri.strict_origin_policy</code>.
      </li>
      <li>
        Double-click on the
        <code>security.fileuri.strict_origin_policy</code> preference to set it to <code>false</code>.
      </li>
    </ol>

    <p>
      FEAScript is distributed under the terms of the
      <a href="https://opensource.org/license/mit" target="_blank">MIT license</a>. Â© 2024 FEAScript.
    </p>

    <!-- JSON fetching -->
    <script>
      let meshConfig, boundaryConditionsConfig;
      const solverConfig = "solidHeatTransferScript"; // Set solverConfig explicitly

      // Function to fetch and parse JSON files
      function fetchJSON(url) {
        return fetch(url).then((response) => response.json());
      }

      // Fetch JSON files asynchronously from the provided URLs
      Promise.all([fetchJSON("meshConfig.json"), fetchJSON("boundaryConditionsConfig.json")]).then(
        ([meshConfigData, boundaryConditionsConfigData]) => {
          meshConfig = meshConfigData;
          boundaryConditionsConfig = boundaryConditionsConfigData;
        }
      );
    </script>

    <!-- FEAScript module and visualization -->
    <script type="module">
      import {
        FEAScript,
        plotSolution,
        printVersion,
      } from "https://feascript.github.io/FEAScript/src/index.js";

      window.addEventListener("DOMContentLoaded", () => {
        // Print FEAScript version in the console
        printVersion();
        // Calculate solution and render plot once JSON data is loaded
        let { solutionVector, nodesCoordinates } = FEAScript(
          solverConfig,
          meshConfig,
          boundaryConditionsConfig
        );
        // Plot the solution as a 2D contour plot
        plotSolution(
          solutionVector,
          nodesCoordinates,
          solverConfig,
          meshConfig.meshDimension,
          "contour",
          "solutionPlot"
        );
      });
    </script>
  </body>
</html>
